CREATE FUNCTION [dbo].[USF_VALIDA_CNPJ](@CNPJX VARCHAR(14)) RETURNS BIT AS   
  
BEGIN    
  
DECLARE @INSCRICAO_FEDERAL VARCHAR(14)   
SET @INSCRICAO_FEDERAL = DBO.NUMERICO(@cnpjx) --   = '11111111111111'  
DECLARE @RESULTADO BIT = 0  
  
DECLARE @COUNT INT = 0  
  
SET @COUNT =  
(  
SELECT  
  COUNT(DISTINCT SUBSTRING(@INSCRICAO_FEDERAL, A.SEQUENCIA, 1))  
FROM  
 VEZES A  
WHERE  
 A.SEQUENCIA <= LEN(@INSCRICAO_FEDERAL)  
)   
  
IF @COUNT = 1  
RETURN (@RESULTADO)  
  
IF ( SELECT 0  
     WHERE DBO.Digito_Cnpj(SUBSTRING(@INSCRICAO_FEDERAL,1,12))=RIGHT(@INSCRICAO_FEDERAL,2)  
) = 0  
BEGIN   
 SET @RESULTADO = 1  
 RETURN (@RESULTADO)  
END  
ELSE  
  BEGIN  
   SET @RESULTADO = 0  
   RETURN (@RESULTADO)  
  END  
  
  
      
RETURN (@resultado)     
END;  
  
